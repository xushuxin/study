#### webpack的作用

1. 代码转换
2. 文件优化
3. 代码分割
4. 模块合并
5. 自动刷新
6. 自动发布

#### 首先必须安装node 

node -v 检测node版本

#### 项目初始化

npm init -y 

#### webpack安装

**下载nrm可以用于切换下载npm包的源**

npm i nrm -g  

执行命令 nrm ls查看当前源

**下载webpack 和 webpack-cli （开发环境依赖）**

npm install  webapck webpack-cli -D

**0配置运行：**

npx  webpack      npx是5.2版本以后npm提供的命令

运行原理：执行node_modules下.bin下可执行文件webapck命令，命令内部会调用webpack-cli解析用户参数进行打包

默认配置：

打包入口文件路径: ./src/index.js

打包输出目录./dist

输出js文件名main.js

默认配置文件：webpack.config.js 或 webpackfile.js

**自定义配置：**

1. package.json的script配置命令

   webpack命令行flags

   --mode 设置模式（生产/开发）

   --config 设置webpack 配置文件的路径

   --env  如果指定的配置文件导出的是一个函数，会把参数传给这个函数第一个形参(webapck4和webpack5有区别)

   以下是webpack4的用法

   ```json
   "script":{
   
   	"dev":"webpack --mode development --config ./webpack.dev.js"
   
   }
   ```

   npm run dev 开发环境运行

   npm run build 生产环境运行

2. webpack具体配置

   webpack配置遵循commonJS语法规范，可以使用node的内置模块

   以开发环境为例：

   webpack.dev.js配置：

   ```JS
   module.exports = {
     mode:"development",//指定webpack所需的mode，可选：development/production
     entry:"./src/index.js",//可以指定一个（或多个）不同的入口起点
     output:{
       path:path.resolve(__dirname,'output'),//打包输出目录
       filename:'index.js'//打包输出的结果文件
     }
   }
   ```

3.公共配置与不同环境配置的合并(两种)

  1) 使用同一个配置文件

+ 不同环境的命令行中通过命令--env的配置不同参数用于区分环境（可以自定义），并且配置文件指向同一个文件，配置文件需要导出一个函数，第一个参数用于接收env的值;
+ 不同环境需要使用同一个配置文件

  2) 把公共配置引入到不同配置文件合并

webpack4实现配置合并需要自己下载引入webpack-merge模块，然后在一个配置文件中（如webpack.config.js）根据env的不同，合并公共配置和对应模式的配置并返回作为最终配置。

webpack5提供命令行模式（--merge, -m）：使用 webpack-merge 合并两个配置文件

例如 `--merge -c ./webpack.config.js -c ./webpack.dev.config.js`

4. 插件的使用(提供额外的功能)

   https://www.npmjs.com/ 搜索对应插件名，查看使用方法和配置

   + **清除输出目录   clean-webapck-plugin**  
   + **把打包后的js文件自动引入到html中   html-webpack-plugin**    
       1. 把指定位置的html文件打包生成到webapck配置的输出目录（可以指定输出的文件名）
       2. 可以自动把webpack打包后的js文件引入html（inject指定位置如'head'、'body'等）
       3. 引入的js可以设置hash
       4. 可以进行一些html文件压缩配置
   + **启动本地服务  webpack-dev-server**

     + 是在**内存中**打包，并且自动启动服务(因为是在内存中打包，所以看不到打包后的文件）

     + **访问本地服务器的地址时，会默认查找是否有html文件，有会默认打开**

       首先,默认访问本地服务器文件时会在webpack打包输出目录查找指定文件（如果该目录下有生成index.html，访问该目录会直接打开html文件）；如果输出目录没有要访问的文件，会基于contentBase路径查找文件，contentBase路径默认是当前文件夹路径，可以修改

     + 开启热更新后，内部使用的js、css修改会页面自动更新，模板文件内容发生改变需要手动刷新页面才能看到更新

5. 多入口打包

   ```js
   
   ```

   